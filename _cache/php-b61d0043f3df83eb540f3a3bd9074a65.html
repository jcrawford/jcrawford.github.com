<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * An Offensive Word Filtering Class</span>
<span class="sd"> *</span>
<span class="sd"> */</span>
<span class="k">class</span> <span class="nc">OffensiveWord</span>
<span class="p">{</span>   
    <span class="k">static</span> <span class="k">private</span> <span class="nv">$_word_list</span><span class="p">;</span>
    <span class="k">static</span> <span class="k">private</span> <span class="nv">$_total_words_in_list</span><span class="p">;</span>

    <span class="sd">/**</span>
<span class="sd">     * Class Constructor</span>
<span class="sd">     * </span>
<span class="sd">     * Currently this is not used because the public methods that are</span>
<span class="sd">     * available are all statically called</span>
<span class="sd">     */</span>
    <span class="k">private</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span> <span class="p">)</span>
    <span class="p">{</span>

    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * Load the offensive word list</span>
<span class="sd">     *</span>
<span class="sd">     * @return boolean</span>
<span class="sd">     */</span>
    <span class="k">private</span> <span class="k">function</span> <span class="nf">load_bad_word_list</span><span class="p">(</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span> 
            <span class="nb">is_file</span><span class="p">(</span> <span class="nx">INCLUDE_DIR</span><span class="o">.</span><span class="s1">&#39;/offensiveword.txt&#39;</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> 
            <span class="nb">is_readable</span><span class="p">(</span> <span class="nx">INCLUDE_DIR</span><span class="o">.</span><span class="s1">&#39;/offensiveword.txt&#39;</span> <span class="p">)</span> 
        <span class="p">)</span>
        <span class="p">{</span>
            <span class="nv">$lines</span> <span class="o">=</span> <span class="nb">file</span><span class="p">(</span> <span class="nx">INCLUDE_DIR</span><span class="o">.</span><span class="s1">&#39;/offensiveword.txt&#39;</span> <span class="p">);</span>
            <span class="nx">self</span><span class="o">::</span><span class="nv">$_total_words_in_list</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span> <span class="nv">$lines</span> <span class="p">);</span>
            <span class="k">for</span><span class="p">(</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;=</span> <span class="p">(</span> <span class="nx">self</span><span class="o">::</span><span class="nv">$_total_words_in_list</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span> <span class="p">)</span> 
                <span class="k">if</span><span class="p">(</span> <span class="nv">$lines</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="p">)</span> 
                    <span class="nx">self</span><span class="o">::</span><span class="nv">$_word_list</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">trim</span><span class="p">(</span> <span class="nx">strtolower</span><span class="p">(</span> <span class="nv">$lines</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="p">)</span> <span class="p">);</span>
            <span class="nb">usort</span><span class="p">(</span><span class="nx">self</span><span class="o">::</span><span class="nv">$_word_list</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nx">self</span><span class="p">,</span> <span class="s1">&#39;sort&#39;</span> <span class="p">)</span> <span class="p">);</span>
            <span class="nv">$lines</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
            <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * Sort the word list by string length, longest to smallest string. </span>
<span class="sd">     * This is the user defined callback function for the usort </span>
<span class="sd">     * function call in the load_bad_word_list method.</span>
<span class="sd">     *</span>
<span class="sd">     * @param string $a</span>
<span class="sd">     * @param string $b</span>
<span class="sd">     * @return integer</span>
<span class="sd">     */</span>
    <span class="k">private</span> <span class="k">function</span> <span class="nf">sort</span><span class="p">(</span> <span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">strlen</span><span class="p">(</span> <span class="nv">$a</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="nb">strlen</span><span class="p">(</span> <span class="nv">$b</span> <span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">strlen</span><span class="p">(</span> <span class="nv">$a</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="nb">strlen</span><span class="p">(</span> <span class="nv">$b</span> <span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

        <span class="c1">// they must be the same length</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * Check to see if there are offensive words in the string</span>
<span class="sd">     *</span>
<span class="sd">     * @param string $string</span>
<span class="sd">     * @return boolean</span>
<span class="sd">     */</span>
    <span class="k">static</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">isOffensive</span><span class="p">(</span> <span class="nv">$string</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">count</span><span class="p">(</span> <span class="nx">self</span><span class="o">::</span><span class="nv">$_word_list</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> 
            <span class="nx">self</span><span class="o">::</span><span class="na">load_bad_word_list</span><span class="p">(</span> <span class="p">);</span>

        <span class="nv">$total_words</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="nv">$_total_words_in_list</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;=</span> <span class="nv">$total_words</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">stripos</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="nx">self</span><span class="o">::</span><span class="nv">$_word_list</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span>
                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * Actually censor out the offensive words from the string.</span>
<span class="sd">     *</span>
<span class="sd">     * @param string $string by reference</span>
<span class="sd">     * @return boolean</span>
<span class="sd">     */</span>
    <span class="k">static</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">censor</span><span class="p">(</span> <span class="o">&amp;</span><span class="nv">$string</span> <span class="o">=</span> <span class="k">null</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span> <span class="nx">self</span><span class="o">::</span><span class="na">isOffensive</span><span class="p">(</span> <span class="nv">$string</span> <span class="p">)</span> <span class="o">===</span> <span class="k">false</span> <span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;=</span> <span class="p">(</span> <span class="nx">self</span><span class="o">::</span><span class="nv">$_total_words_in_list</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">);</span> <span class="nv">$i</span><span class="o">++</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="nv">$string</span> <span class="o">=</span> <span class="nb">eregi_replace</span><span class="p">(</span>
                <span class="nx">self</span><span class="o">::</span><span class="nv">$_word_list</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> 
                <span class="nx">substr</span><span class="p">(</span>
                    <span class="nx">self</span><span class="o">::</span><span class="nv">$_word_list</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> 
                    <span class="mi">0</span><span class="p">,</span> 
                    <span class="mi">1</span>
                <span class="p">)</span><span class="o">.</span>
                <span class="nb">sprintf</span><span class="p">(</span>
                    <span class="s2">&quot;%&#39;*&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nx">self</span><span class="o">::</span><span class="nv">$_word_list</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> 
                    <span class="k">NULL</span>
                <span class="p">)</span><span class="o">.</span><span class="nx">substr</span><span class="p">(</span>
                    <span class="nx">self</span><span class="o">::</span><span class="nv">$_word_list</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> 
                    <span class="nb">strlen</span><span class="p">(</span><span class="nx">self</span><span class="o">::</span><span class="nv">$_word_list</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
                <span class="p">),</span> <span class="nv">$string</span>
            <span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nv">$string</span> <span class="o">=</span> <span class="s1">&#39;Some crappy words are in this crap.&#39;</span><span class="p">;</span>
<span class="nx">OffensiveWord</span><span class="o">::</span><span class="na">censor</span><span class="p">(</span> <span class="nv">$string</span> <span class="p">);</span>
<span class="k">echo</span> <span class="nv">$string</span><span class="p">;</span>
<span class="c1">// outputs: Some c****y words are in this c**p</span>
</code></pre>
</div>
